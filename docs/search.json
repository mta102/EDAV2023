[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Covid-19 Vaccine Hesitance Analysis",
    "section": "",
    "text": "1 Introduction\nVaccine hesitance is where individuals express reluctance or refusal to receive vaccines despite the widespread availability of vaccination services. It has been a longstanding issue in public health globally, despite global public healthcare messaging. Some causes of vaccine hesitance include mistrust in healthcare systems, concerns about vaccine safety or efficacy, religious or cultural beliefs, and misinformation, as mentioned here and here.\nDuring the COVID-19 pandemic, vaccine hesitance was an obstacle in the global response to the virus. The rapid development and deployment of COVID-19 vaccines simultaneously fueled scientific acclaim and concerns about their safety and long-term effects. Misinformation spread rapidly through social media and other channels, contributing to skepticism about the vaccines’ efficacy and safety. These uncertainties, coupled with existing mistrust in government health agencies and pharmaceutical companies, created a fertile ground for vaccine hesitance to take root.\nThe consequences of COVID-19 vaccine hesitance were profound. It slowed efforts to achieve widespread immunity, allowing the virus to persist and mutate, leading to the emergence of more transmissible variants. This prolonged the duration and severity of the pandemic, resulting in increased illness, death, and strain on healthcare systems worldwide, alongside exacerbating the economic and social impacts of the pandemic, as mentioned here.\nThe challenges posed by vaccine hesitance during the COVID-19 pandemic underscore the importance of addressing this issue as an integral part of future public health strategies. To that end, we propose to:\n\nStudy which segments of the population exhibited greatest covid vaccine hesitancy following the deployment of mass vaccinations in the US in early 2021\nAnalyse which segments showed the greatest reduction in covid vaccine hesitancy between 2021 and 2023\nPropose high-level recommendations for segments of the population that need further public health interventions"
  },
  {
    "objectID": "data.html#description",
    "href": "data.html#description",
    "title": "2  Data",
    "section": "2.1 Description",
    "text": "2.1 Description"
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.3 Missing value analysis",
    "text": "2.3 Missing value analysis\n\n2.3.1 Describe any patterns you discover in missing values. If no values are missing, graphs should still be included showing that. (suggested: 2 graphs plus commentary)\nOur missing value analysis analyzes where the missing data is, determines the meaning of the missing data in the specific context of our dataset; we then make appropriate corrections.\n\n\nCode\n# Flag whether a data point is NA\nmissing_vals_matrix &lt;- is.na(as.data.frame(covid))\n\n# Count NAs per column\nmissing_col_count &lt;- colSums(missing_vals_matrix)\n\n# Create a data frame with column names and NA counts\nmissing_vals_count_df &lt;- data.frame(Column = names(missing_col_count),\n                     NA_Count = missing_col_count)\n\n# Plot NA counts per column\n# All NAs are in the Estimate (%) column\nggplot(missing_vals_count_df,\n       aes(x = NA_Count, y = reorder(Column, NA_Count))) +\n  geom_bar(stat = \"identity\", fill = \"cornflowerblue\") +\n  labs(title = \"Missing Values by Column\",\n       x = \"Count of NAs\",\n       y = \"Dataset Attributes\") +\n  theme_bw()\n\n\n\n\n\nCode\n# To understand the NAs further, we made 3 observations which strongly indicates NA are in fact zero:\n\n# Observation 1: All NAs have a valid 95% confidence interval of between 0-0 to 0-0.3.\n\ncovid |&gt; filter(is.na(`Estimate (%)`)) |&gt;\n  ggplot(aes(x = `95% CI (%)`)) +\n  geom_bar(aes(y = (..count..)/sum(..count..)), color = \"black\", fill = \"orange\") +\n  labs(title = \"Confidence Intervals (CI) for NA Values\",\n       x = \"95% CI for NA Values\",\n       y = \"Proportion of Total NA Values\") +\n  theme(axis.text.x = element_text(angle = 0, vjust = 0.5, hjust=0.5))+\n  scale_y_continuous(labels = scales::percent)\n\n\n\n\n\nCode\n# Observation 2: Estimate (%) is rounded to 1 decimal point, and the lowest possible non-NA value is 0.1\ncovid |&gt;\n  group_by(`Estimate (%)`) |&gt;\n  summarize(count = n()) |&gt;\n  filter(`Estimate (%)` &lt;= 0.2 | is.na(`Estimate (%)`)) |&gt;\n  arrange(desc(`Estimate (%)`))\n\n\n# A tibble: 3 × 2\n  `Estimate (%)` count\n           &lt;dbl&gt; &lt;int&gt;\n1            0.2 25242\n2            0.1 30264\n3           NA   31788\n\n\nCode\n# Observation 3: Sense checks on subsets of the data where NAs are present are coherent, with a valid sample size, and the non-NA Estimate (%) summing up to 100\nNA_is_zero_proof1 &lt;- covid |&gt;\n  filter(Geography == \"Wisconsin\", `Time Period` == \"April 22 - May 29\",\n         Year == 2021, `Group Name` == \"Age\",\n         `Indicator Name` == \"Vaccination uptake and intention\",\n         `Group Category` == \"65+ years\") |&gt;\n  select(`Group Category`,`Indicator Category`,`Estimate (%)`,\n         `Sample Size`,`95% CI (%)`)\n\n\n# Therefore, we will impute NAs as zeros \ncovid[is.na(covid)] = 0\n\n# Check: This does remove all NAs\ncolSums(is.na(covid))\n\n\n    Geography Type          Geography         Group Name     Group Category \n                 0                  0                  0                  0 \n    Indicator Name Indicator Category        Time Period               Year \n                 0                  0                  0                  0 \n         Time Type       Estimate (%)         95% CI (%)        Sample Size \n                 0                  0                  0                  0 \n  Suppression Flag \n                 0 \n\n\nOur exploration of NAs in the dataset revealed the following findings:\n\nNAs are isolated to the Estimated (%) column in our dataset.\nThe pattern of NAs across various response rate confidence intervals suggests that these NAs should correspond to a response rate of 0%.\nThis is further supported by another finding: there are 0 rows in the entire dataset showing a true 0% response rate. The lowest values that can be seen are 0.1%.\nMoreover, within each group and indicator containing at least one NA, the sum of response rates across the non-NA values adds up to 100%.\n\nBased on the findings above, we can safely conclude that the NAs in our dataset represent true 0% response rates. As such, we will impute NAs with 0s for our analysis purposes."
  },
  {
    "objectID": "data.html#technical-description",
    "href": "data.html#technical-description",
    "title": "2  Data",
    "section": "2.1 Technical Description",
    "text": "2.1 Technical Description\n\n2.1.1 Identify one or more data sources:\nThe data source which we will use for our study is the CDC’s National Immunization Survey Adult COVID Module (NIS-ACM). It provides information on COVID-19 vaccination status and intent, segmented by geography, age, ethnicity, socio-economic status, and other characteristics. The data can be found here\n\n\n2.1.2 How the data are collected and by whom:\nThe data was collected by the CDC through a series of telephone interviews conducted between April 2021 and June 2023 (latest sample available). Each week, the CDC surveyed between 7,500 to 20,000 US adults aged 18 years and above using a random-digit-dialed sample of cell telephone numbers. These samples were stratified by state, the District of Columbia, and five local jurisdictions (Bexar County, TX; Chicago, IL; Houston, TX; New York City, NY; and Philadelphia County, PA). During some survey periods, Guam, the US Virgin Islands, and Puerto Rico were included as well.\nTo correct any imbalances or biases in the sample that might arise due to the survey design or data collection methods, the CDC applied weights to the proportion of the sampled individuals giving a particular response in the survey.\n\n\n2.1.3 Format of the data:\nThe data is presented as a CSV file in a “pivot longer” format that is downloadable from the CDC’s website provided above. The exact format can be seen without exporting the data using the following link: https://data.cdc.gov/Vaccinations/National-Immunization-Survey-Adult-COVID-Module-NI/udsf-9v7b\nThe first four columns (Geography Type, Geography, Group Name, and Group Category) are used to characterize the segments of individuals who were surveyed, where any given Geography may contain multiple Group Names and Group Categories. For example, the Geographies “Alabama” and “New York” will each have multiple Group Names, such as “Age by race/ethnicity” or “Pregnancy status (females age 18 – 49 years)”.\nThe next two columns in the dataset, Indicator Name and Indicator Category, specify the vaccination status/intent variables being analyzed. Each Indicator Name is comprised of several Indicator Categories. For instance, the Indicator Name “Vaccination uptake and intention” has four possible responses such as “Probably or definitely will not get vaccinated” or “Definitely will get vaccinated”.\nIn addition to the combinations of geographies, participant groups, and survey questions/answers, the data is further subdivided by time period and duration of data collection, which can either be weekly or monthly.\nFor all the permutations mentioned above, the response rates/proportions and their corresponding confidence intervals and sample sizes are recorded in the columns Estimate (%), 95% CI (%), and Sample Size, respectively.\nA complete column-by-column description of all attributes in the dataset is available in the “Columns in This Dataset” section of the page linked below: list https://data.cdc.gov/Vaccinations/National-Immunization-Survey-Adult-COVID-Module-NI/udsf-9v7b\nGiven that the participant demographics and combinations of survey questions and answers have been pivoted, each “row” of data represents a single observation for each segment/demographic.\n\n\n2.1.4 Frequency of updates:\nThe data is updated weekly, with the first samples of data having been collected the week of Apr 22 – May 1 2021 and the latest samples corresponding to the week of June 25 – June 30 2023. The CDC also aggregates its weekly estimates to determine monthly estimates.\n\n\n2.1.5 Dimensions:\nThe data contains 5.08M rows x 13 columns.\n\n\n2.1.6 Other relevant information:\nThe dataset includes the following additional information, which we will not be studying, as it does not directly address the question of vaccine hesitance: - Vaccination coverage - Bivalent booster update & intention\n\n\n2.1.7 Potential issues/concerns with the data:\nThrough data exploration and reviews of the data source documentation, we identified the following potential concerns:\n\nAll responses are self-reported & random dialed, making the data quality susceptible to misreporting by respondents.\nDue to the random sampling performed, the individuals being interviewed will differ from one period of time to another. While this limits our ability to track changes in perspective from the same people over time, it is likely not going to be an issue since we are concerned with population level statistics rather than individual statistics.\nThe sample size in the dataset varies by demographic subgroup. Ideally, it would be stratified, but this is likely not possible due to the random-dialed survey design (i.e. the CDC cannot target phone calls to specific demographics). This is likely accounted for by the CDC’s estimate weighting technique.\nThere appear to be rounding errors in the response rate estimates. For any given combination of geography, participant group, question, and time period, the sum of proportions do not exactly equal 100%. This is due to the response rates in the Estimate (%) column being rounded to just one decimal point. As a result, some sub-samples sum up to 101% across all the response options specified in the Indicator Category.\nThe data contains NAs in the Estimate (%) column. According to the data source documentations, NAs should only be present in smaller sub-samples (&lt;30) for which the data was intentionally suppressed. However, our data exploration revealed that groups with larger sample sizes, even surpassing 10,000, contained NAs in the Estimate (%) column. Conversely, some groups with samples less than 30 do not have NA response rate values. A related concern is that the Suppression Flag (1 = suppressed) should only be set to 1 where sample sizes were smaller than 30; however, we see Suppression values of 1 for groups of larger sizes. In some instances, the Estimate (%) may not be NA, yet the Suppression Flag was still set to 1.\n\n\n\n2.1.8 How to import the data:\n\nSelect Download Data Table from the link provided at the beginning of the technical description.\nOn the following page, select Export from the top right corner next to the Actions button.\nKeep the default Export Format as CSV and click Download.\nOnce downloaded, import the dataset into RStudio for analysis. The function fread() from the data.table library is recommended to reduce load time."
  },
  {
    "objectID": "data.html#research-plan",
    "href": "data.html#research-plan",
    "title": "2  Data",
    "section": "2.2 Research plan",
    "text": "2.2 Research plan\n\n2.2.1 Explain in detail how your data will enable you to answer your research questions from the introduction.\nThe dataset chosen provides a number of interesting factors to be examined in the context of vaccine hesitance. Below, we have outlined the fields we plan to leverage in order to explore potential relationships between our dependent variable - vaccine hesitance response rates - and various independent variables such as geography, age, and ethnicity.\nDependent Variable(s)\nThe data contains the following dependent variables of interest to our study, which can be identified by filtering our starting-point table for Indicator Name = “Vaccine uptake and intention”:\n\nEstimate (%) (i.e., response rate) for Indicator Category = “Probably or definitely will not get vaccinated”\nEstimate (%) for Indicator Category = “Probably will not get vaccinated or unsure”\nEstimate (%) for Indicator Category = “Definitely will get vaccinated”\nEstimate (%) for Indicator Category = “Vaccinated (&gt;=1 dose)”\n\nWhere applicable, we can combine the dependent variables above into the following two options:\n\nHesitant: Indicator Category = “Probably or definitely will not get vaccinated”\nNot hesitant or unsure: all other values in the ‘Indicator Category’\n\nIndependent variables\nThe correlation between the hesitance and the following independent variables (as defined by the column “Group Name”) will be studied initially nationally (as defined by the column “Geography”), but any geographical disparities may be highlighted on a case by case basis:\nDemographics:\n\nGender\nAge\nRace\nAge & race\nSexual orientation\nGender identity\nRural/urban\nBirth\nInterview language\nPoverty\nInsurance\nSocial vulnerability index (SVI)\nPolitical leaning\n\nHealth condition\n\nPrevious vaccination status\nComorbidity\nDisability\nPregnancy\nPast covid-19 contraction\nReaction to previous dose of vaccine\n\n“Thinking & feeling”\n\nConcern about getting disease\nVaccine safety concerns\n“Importance” of vaccine\n\nSocial pressure\n\nRecommended by healthcare providers\nFamily & friends’ vaccination status\nEmployer vaccine mandate\n\nLogistics\n\nDifficulty in accessing vaccine (general “difficulty”, distance to site, convenience, uncertainty about eligibility, cost, difficulty in getting an appointment)\n\nTime window\nWe would also like to study changes in hesitance at particular points in time and changes over a large period of time (2 years, from Apr/May 2021 to Jun 2023). As such, we we will use the Time Period field as another variable for this analysis. While the data is broken down between weekly and monthly samples, we will be focusing on monthly data for our study. This is because we do not expect significant changes in hesitance on a weekly basis, and attempting to compare weekly data could be subject to sampling error due to the random-dialed study design.\n\n\n2.2.2 Approach:\nOur analysis approach can be broken down into the following key activities:\n\n2.2.2.1 Part 1: Study which segments of the population exhibited greatest covid vaccine hesitancy following the deployment of mass vaccinations in the US in early 2021.\nThis process will consist of the following steps:\n\nWriting R-code to auto rank every possible segment’s hesitance by statistical significance (i.e. using p-values and test-statistics from Chi-sq tests) at a point in time specified below.\nBuilding visuals of the 10 segments with the strongest association to vaccine hesitance to draw additional insights. For this step, we are considering using the following graph types: (x / indpt vars are cat: y / dep vars are numerical (% or n stating “Probably or definitely will not get vaccinated”)\nBars / stacked bars\nMosaic plots\nSpatial heatmaps\nThe snapshot in time we will be using to measure associations will comprise of the first three monthly periods of data available, where the average proportion of responses corresponding to vaccine hesitance was ~18%. To combine the three monthly periods, we will create a weighted average of the survey responses. For instance, if vaccine hesitance rates for a particular group were 20 out 100 (20%) in month 1, 20/150 (13%) in month 2, and 10/90 (11%) in month 3, the weighted average hesitance rate for that group would be 50/340 (14.7%).\n\nThe rationale for choosing the first three monthly periods of data is due to the prevalence and relative stability of hesitance during that time frame. Below, we will visualize vaccine hesitance over time to illustrate this.\n\n2.2.2.1.1 Import Libraries\n\n\nCode\n# install.packages(\"data.table\")\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(lubridate)\n\n\n\n\n2.2.2.1.2 Import dataset\n\n\nCode\n# Load dataset\ncovid &lt;- fread(\"../covid_dataset/covid.csv\")\n\n\n\n\n2.2.2.1.3 Plot vaccine hesitance over time\n\n\nCode\n# Filter for the vaccination uptake and intent indicator\n# Filter for responses corresponding to vaccine hesitancy\n# Include all adults 18+\n# Set time period to monthly (excluding weekly samples) and filter for nationwide samples\nvacc_intention_time &lt;- covid |&gt;\n  filter(`Indicator Name` == 'Vaccination uptake and intention') |&gt;\n  filter(`Indicator Category` == 'Probably or definitely will not get vaccinated') |&gt;\n  filter(`Group Name` == 'All adults 18+') |&gt;\n  filter(`Time Type` == 'Monthly') |&gt;\n  filter(Geography == 'National') |&gt;\n  arrange(`Geography Type`, Geography, `Time Period`)\n\n# Derive month of data collection\nvacc_intention_time &lt;- vacc_intention_time |&gt;\n  mutate(month_split = paste0(str_split(`Time Period`, \"-\",\n                                        simplify = TRUE)[, 2],\n         \", \", Year),\n         month = mdy(month_split))\n\n# Plot hesitancy over time\nggplot(vacc_intention_time, aes(x = month, y = `Estimate (%)`,\n                                color = `Indicator Category`)) +\n  geom_line() +\n  labs(title = \"U.S. Vaccination Response Rates Over Time\",\n       x = \"Month\",\n       y = \"Response Rate (%)\") +\n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(title = \"Indicator Category:\"))\n\n\n\n\n\n\n\n\n2.2.2.2 Part 2: Analyze which segments showed the greatest reduction in covid vaccine hesitancy between 2021 and 2023\nWe will analyse which segments showed the greatest reduction in COVID vaccine hesitancy between 2021 and 2023. To perform this step, we will leverage several visuals that can provide insights into trends of hesitancy over time:\n\nCleveland dot plot - plot or annual snapshot of change in variable(s) of interest over time\nGeographic heatmap (colours = changes)\nBar chart\n\n\n\n2.2.2.3 Part 3: Based on the findings above, we will propose high-level recommendations for segments of the population that need further public health interventions."
  },
  {
    "objectID": "results.html",
    "href": "results.html",
    "title": "3  Results",
    "section": "",
    "text": "Import libraries\n\n\nCode\n# install.packages(\"choroplethr\")\n# install.packages(\"RColorBrewer\")\n# install.packages(\"GGally\")\n# install.packages(\"devtools\")\n# install.packages(\"remotes\")\n# install.packages(\"choroplethrMaps\")\n# devtools::install_github(\"timelyportfolio/parcoords\")\n\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(vcd)\nlibrary(choroplethrMaps)\nlibrary(GGally)\nlibrary(parcoords)\nlibrary(RColorBrewer)\nlibrary(choroplethr)\nlibrary(lubridate)\n\n\nImport starting dataset and filter for vaccine hesitance indicator and monthly samples\n\n\nCode\n# Load vaccine hesitancy data\ncovid &lt;- fread(\"../covid_dataset/covid.csv\")\n\n# Filter for Monthly sample period and vaccine hesitance responses\ncovid_hes &lt;- covid |&gt;\n  filter(`Time Type` == \"Monthly\",\n         `Indicator Category` == \"Probably or definitely will not get vaccinated\")\n\n\nPrep data for analysis. The following chunk truncates the names of population segments for data visualization purposes\n\n\nCode\n# Create vector of shortened group names\ngroup_name_shortening &lt;- c(\"Age\" = \"Age\",\n                           \"Age by race/ethnicity\" = \"Age.Race\",\n                           \"All adults 18+\" = \"18+ Adults\",\n                           \"Born in the U.S.\" = \"US.Born\",\n                           \"Concern about getting COVID-19 disease\" = \"Covid.Concern\",\n                           \"Confidence in COVID-19 vaccine safety\" = \"Vaccine.Confiden\",\n                           \"Confidence that COVID-19 vaccine is important\" = \"Vaccine.Imprtnt\",\n                           \"COVID-19 vaccination status of friends and family\" = \"Fr.Fam.Vaccd\",\n                           \"COVID-19 vaccine information seeking frequency in past month\" = \"Vacc.Info.Seek\",\n                           \"Disability status (any)\" = \"Disability\",\n                           \"Essential worker group\" = \"Ess.Wrkr.grp\",\n                           \"Ever had COVID-19 disease (self-report)\" = \"Past.Covid\",\n                           \"Gender identity\" = \"G.Identity\",\n                           \"Have a regular physician or provider for primary care\" = \"Prim.Care.Providr.Status\",\n                           \"Health condition associated with higher risk for COVID-19 (any)\" = \"Comorbidity\",\n                           \"Healthcare provider recommended I get a COVID-19 booster\" = \"Dr.Recommend.Boostr\",\n                           \"Healthcare provider recommended I get a COVID-19 vaccine\" = \"Dr.Recommend.Vacc\",\n                           \"Insurance status\" = \"Insurance\",\n                           \"Language of interview\" = \"Language\",\n                           \"Mask-wearing frequency\" = \"Mask.Use\",\n                           \"Mental health status\" = \"Mental.Health\",\n                           \"Metropolitan statistical area\" = \"Rural.Urban\",\n                            \"Political leaning of county of residence\" = \"Political\",\n                           \"Poverty status\" = \"Pov.Status\",\n                           \"Pregnancy status (females age 18 – 49 years)\" = \"Pregnancy\",\n                           \"Race/Ethnicity (4 level)\" = \"Race.4lvl\",\n                           \"Race/Ethnicity (7 level)\" = \"Race.7lvl\",\n                           \"Received a flu vaccination\" = \"Flu.Vacc\",\n                           \"Received non-COVID-19 vaccine(s) in past two years\" = \"Past.Vaccin\",\n                           \"Self-perceived equity in seeking healthcare compared to other races/ethnicities\" = \"Racial.Equity\",\n                           \"Sex\" = \"Sex\",\n                           \"Sexual orientation\" = \"S.Orientation\",\n                           \"Social Vulnerability Index (SVI) of county of residence\" = \"SVI\",\n                           \"Speaks a language other than English at home\" = \"Non.Englsh.Language\",\n                           \"Work or school requires COVID-19 vaccination\" = \"Work.School\")\n\n# Construct dataframe from vector\ngroup_name_shortened &lt;- data.frame(`Group Name` = names(group_name_shortening), shortened_group = group_name_shortening, stringsAsFactors = FALSE)|&gt;\n  dplyr::rename(`Group Name` = Group.Name)\n\n# Create vector of shortened group category names\ngroup_cat_shortening &lt;- c(\"18 – 49 years\" = \"18 – 49\",\n                          \"50 – 64 years\" = \"50 – 64\",\n                          \"65+ years\" = \"65+\",\n                          \"18 – 49 years, Black, non-Hispanic\" = \"18 – 49, Black\",\n                          \"18 – 49 years, Hispanic\" = \"18 – 49, Hispanic\",\n                          \"18 – 49 years, Other or multiple races, non-Hispanic\" = \"18 – 49, Other\",\n                          \"18 – 49 years, White, non-Hispanic\" = \"18 – 49, White\",\n                          \"50 – 64 years, Black, non-Hispanic\" = \"50 – 64, Black\",\n                          \"50 – 64 years, Hispanic\" = \"50 – 64, Hispanic\",\n                          \"50 – 64 years, Other or multiple races, non-Hispanic\" = \"50 – 64, Other\",\n                          \"50 – 64 years, White, non-Hispanic\" = \"50 – 64, White\",\n                          \"65+ years, Black, non-Hispanic\" = \"65+, Black\",\n                          \"65+ years, Hispanic\" = \"65+, Hispanic\",\n                          \"65+ years, Other or multiple races, non-Hispanic\" = \"65+, Other\",\n                          \"65+ years, White, non-Hispanic\" = \"65+, White\",\n                          \"Born in the U.S.\" = \"US Born\",\n                          \"Not born in the U.S.\" = \"Not US Born\",\n                          \"Many or almost all family or friends have received vaccine\" = \"Many\",\n                          \"Some or no family or friends have been vaccinated\" = \"No_some\",\"A little or not at all concerned\" = \"A little_not\",\n                          \"Very or moderately concerned\" = \"Very_Moderately\",\n                          \"Somewhat or not at all safe for me\" = \"Not at all_Somewhat\",\n                          \"Very or completely safe for me\" = \"Very\",\n                          \"A little or not at all important to protect me from COVID-19\" = \"A little_not at all\",\n                          \"Somewhat or very important to protect me from COVID-19\" = \"Somewhat_very\",\n                          \"No\" = \"No\",\n                          \"Yes\" = \"Yes\",\n                          \"Cisgender\" = \"Cisgender\",\n                          \"Don't know/refused\" = \"Dont know\",\n                          \"Transgender/Non-binary\" = \"TG/Non bin\",\n                          \"Insured\" = \"Insured\",\n                          \"Not insured\" = \"Not insured\",\n                          \"English\" = \"English\",\n                          \"Other\" = \"Other\",\n                          \"Spanish\" = \"Spanish\",\n                          \"Rural\" = \"Rural\",\n                          \"Suburban\" = \"Suburban\",\n                          \"Urban\" = \"Urban\",\n                          \"Democrat-leaning\" = \"Democrat\",\n                          \"Not Democrat-leaning or Republican-leaning\" = \"None\",\n                          \"Republican-leaning\" = \"Republican\",\n                          \"Above poverty, income &lt;$75k\" = \"&lt;$75k\",\n                          \"Above poverty, income &gt;=$75k\" = \"&gt;=$75k\",\n                          \"Below poverty\" = \"Below poverty\",\n                          \"Unknown income\" = \"Unknown\",\n                          \"Breastfeeding\" = \"Breastfeeding\",\n                          \"Not pregnant, trying to get pregnant, or breastfeeding\" = \"Not pregnant\",\n                          \"Pregnant\" = \"Pregnant\",\n                          \"Trying to get pregnant\" = \"Trying to get pregnant\",\n                          \"American Indian/Alaska Native, non-Hispanic\" = \"Native\",\n                          \"Asian, non-Hispanic\" = \"Asian\",\n                          \"Black, non-Hispanic\" = \"Black\",\n                          \"Hispanic\" = \"Hispanic\",\n                          \"Native Hawaiian/Pacific Islander, non-Hispanic\" = \"Pacific\",\n                          \"Other or multiple races, non-Hispanic\" = \"Other\",\n                          \"White, non-Hispanic\" = \"White\",\n                          \"Female\" = \"Female\",\n                          \"Male\" = \"Male\",\n                          \"Gay/Lesbian/Bisexual/Other\" = \"LGB\",\n                          \"Heterosexual/Straight\" = \"Hetero\",\n                          \"High SVI\" = \"High\",\n                          \"Low SVI\" = \"Low\",\n                          \"Moderate SVI\" = \"Moderate\",\n                          \"SVI unknown\" = \"Unknown\",\n                          \"Not applicable/unemployed\" = \"Unemployed\",\n                          \"All adults age 18+ years\" = \"18+ Adults\",\n                          \"Essential healthcare\" = \"Ess.Healthcare\",\n                          \"Other essential worker\" = \"Ess.Other\",\n                          \"Other frontline worker\" = \"Frontline.Other\",\n                          \"Persons who are not essential workers\" = \"Not.Ess.Wrkr\",\n                          \"School and childcare\" = \"School.Childcare\",\n                          \"Better than other races or ethnicities\" = \"Better\",\n                          \"Same as other races or ethnicities\" = \"Equal\",\n                          \"Worse than other races or ethnicities\" = \"Worse\",\n                          \"Did not receive flu vaccination\" = \"No\",\n                          \"Received a flu vaccination\" = \"Yes\",\n                          \"Political leaning unknown\" = \"Unknown\",\n                          \"Often or sometimes\" = \"Often.Sometimes\",\n                          \"Rarely or never\" = \"Rarely.Never\",\n                          \"Always or often wears mask\" = \"Always.Often\",\n                          \"Sometimes, rarely, or never wears mask\" = \"Occasional.Never\",\n                          \"Excellent, very good, or good\" = \"Excellent.Good\",\n                          \"Fair or poor\" = \"Fair.Poor\")\n\n# Construct dataframe from vector\ngroup_cat_shortened &lt;- data.frame(`Group Category` = names(group_cat_shortening), shortened_cat = group_cat_shortening, stringsAsFactors = FALSE) |&gt;\n  dplyr::rename(`Group Category` = Group.Category)\n\n# Join shortened group names and categories to master table\ncovid_hes_prepped &lt;- left_join(left_join(covid_hes, group_name_shortened,\n                                         by = \"Group Name\"),\n                                         group_cat_shortened, by = \"Group Category\")\n\n\n# Create combinations of group names and categories via paste function\n# Include string wrapped version of text for visualization purposes\ncovid_hes_prepped &lt;- covid_hes_prepped |&gt;\n  mutate(concat = paste(shortened_group, shortened_cat, sep = \" - \"),\n         concat_wrap = str_wrap(concat, width = 10))\n\n\n\n3.0.0.1 Part 1: Study which segments of the population exhibited greatest covid vaccine hesitancy following the deployment of mass vaccinations in the US in early 2021.\nThe national average COVID hesitance rate reported during the first quarter of the data collection period (April - July 2021) was 17.7%. In Part 1, we will break down this percentage across U.S. geographies, identifying the states with the highest and lowest hesitancy rates. We will then analyze the types of population demographics (e.g., age, vaccination history, ethnicity, etc.) that had a strong association with COVID vaccine hesitancy.\nTo obtain an initial baseline of vaccine hesitance rates, we developed the chunk of code below, which revealed that the nationwide hesitance rate from April 2021 to July 2021 was 17.7% nationwide. In other words, 17.7% of those surveyed after the mass deployment of vaccinations responded that they would probably or definitely not get vaccinated.\n\n\nCode\n# Store values of months that will be combined to analyze hesitancy when vaccines were initially released in 2021\nperiods_to_combine_2021 &lt;- c(\"April 22 - May 29\",\"May 30 - June 26\",\"June 27 - July 31\")\n\n# Calculate overall nationwide hesitancy\nnational_hesitance_rate &lt;- covid_hes_prepped |&gt;\n  filter(`Year` == 2021,\n         `Time Period` %in% periods_to_combine_2021,\n         `Group Category`== \"All adults age 18+ years\",\n         Geography == \"National\") |&gt;\n  mutate(n_hesitant = round(`Estimate (%)`/100 * `Sample Size`,0)) |&gt;\n  group_by(Geography) |&gt;\n  summarise(`Sample Size` = sum(`Sample Size`), n_hesitant = sum(n_hesitant)) |&gt;\n  mutate(`Estimate (%)` = n_hesitant / `Sample Size` * 100,\n         `Time Period` = \"2021 analysis period\",\n         Year = 2021) \n\n\nWe began our analysis of variation in hesitancy rates by calculating hesitancy during the April-July 21’ timeframe by state. As illustrated in the map below, states such as Hawaii, New York, and Vermont exhibited the lowest hesitance, while other states like Wyoming, North Dakota, and West Virginia exhibited the highest hesitance.\n\n\nCode\n# Calculate early 2021 hesitance by state\ncovid_2021_analysis_allstates &lt;- covid_hes_prepped |&gt;\n  filter(`Year` == 2021,\n         `Time Period` %in% periods_to_combine_2021,\n         `Group Category`== \"All adults age 18+ years\",\n         `Geography Type` %in% c(\"Jurisdictional Estimates\"),\n         !grepl(\"-\", Geography)) |&gt;\n  mutate(n_hesitant = round(`Estimate (%)`/100 * `Sample Size`,0)) |&gt;\n  group_by(Geography) |&gt;\n  summarise(`Sample Size` = sum(`Sample Size`),\n            n_hesitant = sum(n_hesitant)) |&gt;\n  mutate(`Estimate (%)` = n_hesitant / `Sample Size` * 100,\n         `Time Period` = \"2021 analysis period\",\n         Year = 2021)\n\n# Prep dataframe to be used in the state_choropleth function\ncovid_2021_analysis_allstates_map &lt;- covid_2021_analysis_allstates |&gt;\n  select(Geography, `Estimate (%)`) |&gt;\n  transmute(region = tolower(Geography), value = `Estimate (%)`)\n\n\n# Display state heatmap of hesitance rates\nstate_choropleth(covid_2021_analysis_allstates_map,\n                 title = \"   April-July 2021 COVID-19 Vaccine Hesitance Rates by State\",\n                 legend = \"Hesitancy Rates (%) \")\n\n\n\n\n\nThe histogram and boxplot below show that there are no clear outlier states. The code we developed also searches for outlier values using the lower and upper bounds of the distribution (lower bound = Q1 - 1.5xIQR, upper bound = Q3 + 1.5xIQR). While no outliers were identified, we will see how hesitance rates within states can vary significantly from one population segment to another.\n\n\nCode\n# Plot histogram of state hesitance rates\nggplot(covid_2021_analysis_allstates, aes(x = `Estimate (%)`)) +\n  geom_histogram(bins = 8, fill = \"blue\", color = \"black\", alpha = 0.7) +\n  geom_boxplot() +\n  labs(title = \"State distribution of hesitance\", x = \"Hesitance %\", y = \"No. of states\")\n\n\n\n\n\nCode\n# Search for outliers\nn_outliers &lt;- covid_2021_analysis_allstates |&gt;\n  mutate(lower_bound = quantile(`Estimate (%)`, 0.25) - 1.5*IQR(`Estimate (%)`),\n         upper_bound = quantile(`Estimate (%)`, 0.75) + 1.5*IQR(`Estimate (%)`)) |&gt;\n  filter(`Estimate (%)` &lt; lower_bound & `Estimate (%)` &gt; upper_bound)\n\n\nBefore diving into each state further, we examined the population segments with relatively higher vaccine hesitance rates from April-July 2021. Nationally, it can be seen that the 10 segments displayed below demonstrated the highest hesitance. Each segment represents a group of individuals who provided a particular response. For instance, “Fr.Fam.Vaccd - No_some” represents individuals who responded “No or some” to whether their friends and/or family are vaccinated.\n\n\nCode\n# Create vector of all group names as represented in the data\ngroup_name_toloop &lt;- c(\"Sex\",\"Age\",\"Race/Ethnicity (7 level)\",\"Age by race/ethnicity\",\"Sexual orientation\",\"Gender identity\",\"Metropolitan statistical area\",\"Born in the U.S.\", \"Language of interview\",\"Poverty status\", \"Insurance status\",\"Social Vulnerability Index (SVI) of county of residence\", \"Political leaning of county of residence\", \"Received non-COVID-19 vaccine(s) in past two years\", \"Health condition associated with higher risk for COVID-19 (any)\",\"Disability status (any)\", \"Pregnancy status (females age 18 – 49 years)\", \"Ever had COVID-19 disease (self-report)\",\"Concern about getting COVID-19 disease\", \"Confidence in COVID-19 vaccine safety\",  \"Confidence that COVID-19 vaccine is important\", \"Healthcare provider recommended I get a COVID-19 vaccine\",  \"COVID-19 vaccination status of friends and family\",\"Work or school requires COVID-19 vaccination\" )\n\n\ngroup_name_toloop_short &lt;- lapply(group_name_toloop, function(x) ifelse(x %in% names(group_name_shortening), group_name_shortening[[x]], x))\n  \n\n# Calculate vaccine hesitance by group category/population segment\ncovid_2021_analysis &lt;- covid |&gt;\n  filter(`Year` == 2021, `Time Period` %in% periods_to_combine_2021,\n         `Group Name` %in% group_name_toloop,\n         `Geography Type` %in% c(\"Jurisdictional Estimates\",\n                                 \"National Estimates\"),\n         `Indicator Category` == \"Probably or definitely will not get vaccinated\",\n         !grepl(\"-\", Geography)) |&gt;\n  mutate(n_hesitant = round(`Estimate (%)`/100 * `Sample Size`,0)) |&gt;\n  group_by(pick(c(1:6))) |&gt;\n  summarise(`Sample Size` = sum(`Sample Size`),\n            n_hesitant = sum(n_hesitant)) |&gt;\n  filter(Geography == \"National\") |&gt;\n  mutate(`Estimate (%)` = n_hesitant / `Sample Size` * 100,\n         `Time Period` = \"2021 analysis period\",Year = 2021)\n\n\n# Join shortened group names and categories to master table\ncovid_2021_analysis &lt;- left_join(left_join(covid_2021_analysis, group_name_shortened,\n                                         by = \"Group Name\"),\n                                         group_cat_shortened, by = \"Group Category\")\n\n\n# Create combinations of group names and categories via paste function\n# Include string wrapped version of text for visualization purposes\ncovid_2021_analysis &lt;- covid_2021_analysis |&gt;\n  mutate(concat = paste(shortened_group, shortened_cat, sep = \" - \"),\n         concat_wrap = str_wrap(concat, width = 10),\n         `Group Name` = shortened_group,\n         `Group Category` = shortened_cat) |&gt;\n  select(-c(shortened_group, shortened_cat))\n\n\n# Visualize the 10 categories with the highest hesitance rates\ncovid_2021_analysis |&gt; ungroup() |&gt; top_n(10, `Estimate (%)`) |&gt;\n  ggplot(aes(x = fct_reorder(concat_wrap, -(`Estimate (%)`)),\n             y = `Estimate (%)`)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Top 10 categories with the highest hesitance in 2021\",\n       x = \"Group categories\", y = \"2021 hesitance (%)\") +\n  theme_minimal() + \n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1,size=6),\n        axis.text.y = element_text(size = 8),\n        axis.title = element_text(size = 8),\n        plot.title = element_text(size = 12))\n\n\n\n\n\nCode\n# Store the categories with the highest hesitance rates in a single-column dataframe\ntop_10_highest_hesitance_cat_list &lt;- covid_2021_analysis |&gt;\n  ungroup() |&gt;\n  top_n(10, `Estimate (%)`) |&gt; select(concat)\n\n\nTo dive deeper into the variations in vaccine hesitance by state, we focused on the 10 most and least hesitant states and explored how their respective hesitance rates differed by population segment. Rather than considering all population segments, we narrowed the groups to those that, nationally, had the highest hesitance (see graph above).\nTo facilitate our investigation, we created a set of parallel coordinate plots for the group of 10 most hesitant states and the group of 10 least hesitant states. In both cases, the hesitance rates were not uniform across all population segments. In particular, the group of individuals who responded “A little or not at all” to whether vaccines are important to them showed remarkably higher hesitance rates at the state level.\nAnother question we looked at via interactive parallel coordinates plots is whether states with higher overall hesitance rates would consistently have higher rates at the population segment level. Conversely, we looked at whether states with lower overall hesitance rates had consistently lower rates relative to other states at the population segment level. The plots created revealed that no clear pattern existed for knowing whether a top 10 hesitant state would necessarily be in the top 10 for all population segments. For example, California had the highest hesitance among white individuals aged 18-49 but was not in the top 9 states for hesitance among those who have not previously been vaccinated (see segment = “Past.Vaccin - No”).\n\n\nCode\n# Calculate hesitance over three months in 2021 by state and group category\n# Clean state column\nstate_group_analysis &lt;- covid |&gt;\n  filter(`Year` == 2021,\n         `Time Period` %in% periods_to_combine_2021,\n         `Geography Type` == \"Jurisdictional Estimates\",\n         `Indicator Category` == \"Probably or definitely will not get vaccinated\",\n         !grepl(\"-\", Geography)) |&gt;\n  mutate(n_hesitant = round(`Estimate (%)`/100 * `Sample Size`, 0)) |&gt;\n  group_by(Geography, `Group Name`, `Group Category`) |&gt;\n  summarise(`Sample Size` = sum(`Sample Size`),\n            n_hesitant = sum(n_hesitant)) |&gt;\n  mutate(`Estimate (%)` = n_hesitant / `Sample Size` * 100,\n         `Time Period` = \"2021 analysis period\",\n         Year = 2021) |&gt;\n  ungroup()\n\n\n# Shorten group names\nstate_group_analysis &lt;- state_group_analysis |&gt;\n  mutate_at(vars(`Group Name`), ~recode(., !!!group_name_shortening))\n\nstate_group_analysis &lt;- state_group_analysis |&gt;\n  mutate_at(vars(`Group Category`), ~recode(., !!!group_cat_shortening))\n\nstate_group_analysis &lt;- state_group_analysis |&gt; mutate(concat = paste(`Group Name`, `Group Category`, sep = \" - \"))\n\nstate_group_analysis$concat_wrap &lt;- str_wrap(state_group_analysis$concat, width = 10)\n\n\n# Filter groups for top most hesitant\n# Pivot wider to convert row-level categories to columns containing hesitancy rates\nstate_group_analysis_pivot &lt;- state_group_analysis |&gt;\n  filter(concat %in% top_10_highest_hesitance_cat_list$concat) |&gt;\n  select(Geography, `Estimate (%)`, concat_wrap) |&gt;\n  pivot_wider(id_cols = Geography, names_from = \"concat_wrap\",\n              values_from = \"Estimate (%)\")\n\n# Pregnancy - pregnant is not available at the state level during the filtered timeframe\nstate_not_in_top_10 &lt;- top_10_highest_hesitance_cat_list |&gt;\n  filter(!concat %in% state_group_analysis$concat)\n\npregnancy_check &lt;- covid |&gt;\n  filter(`Group Category` == \"Pregnant\") |&gt;\n  distinct(`Geography Type`, Geography, `Group Name`, `Group Category`,\n           `Time Period`, Year)\n\n# Identify top most hesitant states\ntop_10_hesistant_states &lt;- covid_2021_analysis_allstates |&gt;\n  arrange(desc(`Estimate (%)`)) |&gt;\n  filter(!Geography %in% c(\"Guam\",\"Puerto Rico\")) |&gt;\n  slice(1:10)\n  \n# Identify top least hesitant states\nbottom_10_hesistant_states &lt;- covid_2021_analysis_allstates |&gt;\n  arrange(`Estimate (%)`)|&gt;\n  filter(!Geography %in% c(\"Guam\",\"Puerto Rico\")) |&gt;\n  slice(1:10)\n\n# Filter pivoted data on most hesitant states\ntop_10_parallel_analaysis &lt;- state_group_analysis_pivot |&gt;\n  filter(Geography %in% top_10_hesistant_states$Geography)\n\n\n# Display parallel coordinates plot for most hesitant states\nggparcoord(top_10_parallel_analaysis |&gt; select(where(~!any(is.na(.)))), columns = c(2:8),\n           scale = \"globalminmax\",\n           alpha = 0.4) +\n    labs(title = \"Top categories with the highest hesitance in 2021\",\n       x = \"Group categories\", y = \"2021 hesitance (%)\")\n\n\n\n\n\nCode\n# Display interactive version\ntop_10_parallel_analaysis |&gt; select(where(~!any(is.na(.))))|&gt;\n  parcoords(rownames = F, brushMode = \"1D-axes\", reorderable = T, queue = T)\n\n\n\n\n\n\nCode\n# Filter pivoted data on least hesitant states\nbottom_10_parallel_analaysis &lt;- state_group_analysis_pivot |&gt;\n  filter(Geography %in% bottom_10_hesistant_states$Geography)\n\n\n# Display parallel coordinates plot for least hesitant states\nggparcoord(bottom_10_parallel_analaysis |&gt; select(where(~!any(is.na(.)))), \n           columns = c(2:7),   \n           scale = \"globalminmax\",\n           alpha = 0.4) +\n    labs(title = \"Top categories with the highest hesitance in 2021\",\n       x = \"Group categories\", y = \"2021 hesitance (%)\")\n\n\n\n\n\nCode\n# Display interactive version\nbottom_10_parallel_analaysis |&gt;\n  select(where(~!any(is.na(.))))|&gt;\n  parcoords(rownames = F, brushMode = \"1D-axes\", reorderable = T, queue = T)\n\n\n\n\n\n\nGiven the inconsistent trends seen across states and population categories with the highest hesitance, we proceeded to conduct chi squared tests on every group name defined within the scope of this exercise [link back to data.qmd] to determine those with the highest statistical significance. For instance, does\n\n\nCode\nget_chi_sq &lt;- function(df, geography, time_period, year, group_name, hesitant_group) {\n  \n  temp &lt;- df |&gt; filter(Geography == geography,\n                       `Indicator Name`== \"Vaccination uptake and intention\",\n                       `Time Period` == time_period,\n                       Year == year,\n                       `Group Name`== group_name) |&gt;\n    mutate(hesitant = ifelse(`Indicator Category` %in% hesitant_group,1,0)) |&gt;\n    group_by(`Group Category`,hesitant) |&gt;\n    summarise(hesitance_rate = sum(`Estimate (%)`),\n              sample_size = first(`Sample Size`)) |&gt;\n    mutate(n_hesitance = round(hesitance_rate/100 * sample_size,0)) |&gt;\n    filter(hesitant == 1) |&gt;\n    select(`Group Category`,n_hesitance,sample_size)\n  \n  if(nrow(temp) &gt; 0) {\n    expected_proportion &lt;- sum(temp$n_hesitance)/sum(temp$sample_size)\n\n  temp &lt;- temp |&gt;\n    mutate(expected = sample_size*expected_proportion)\n  \n  res = chisq.test(x = temp$n_hesitance, p = temp$expected/sum(temp$expected))\n  output &lt;- list(round(res$statistic,digits = 0), res$p.value)\n    \n  }\n  else {\n    output &lt;- list(0,0)\n    \n  }\n  \n  \n   return(output)\n}\n\ngroup_name_toloop &lt;- c(\"Sex\",\"Age\",\"Race/Ethnicity (7 level)\",\"Age by race/ethnicity\",\"Sexual orientation\",\"Gender identity\",\"Metropolitan statistical area\",\"Born in the U.S.\", \"Language of interview\",\"Poverty status\", \"Insurance status\",\"Social Vulnerability Index (SVI) of county of residence\", \"Political leaning of county of residence\", \"Received non-COVID-19 vaccine(s) in past two years\", \"Health condition associated with higher risk for COVID-19 (any)\",\"Disability status (any)\", \"Pregnancy status (females age 18 – 49 years)\", \"Ever had COVID-19 disease (self-report)\",\"Concern about getting COVID-19 disease\", \"Confidence in COVID-19 vaccine safety\",  \"Confidence that COVID-19 vaccine is important\", \"Healthcare provider recommended I get a COVID-19 vaccine\",  \"COVID-19 vaccination status of friends and family\",\"Work or school requires COVID-19 vaccination\" )\n\ngroup_name_toloop_short &lt;- lapply(group_name_toloop, function(x) ifelse(x %in% names(group_name_shortening), group_name_shortening[[x]], x))\n  \n\nresult_df2 &lt;- data.frame(matrix(ncol = 3, nrow = 0))\ncolnames(result_df2) &lt;- c(\"group_name\", \"X2_test_stat\", \"p_value\")\n\nfor (x in group_name_toloop_short) {\n  res &lt;- get_chi_sq(covid_2021_analysis,geography = \"National\",\n                    time_period = \"2021 analysis period\",\n                    year = 2021,\n                    group_name = x,\n                    hesitant_group = c(\"Probably or definitely will not get vaccinated\"))\n  result_df2[nrow(result_df2) + 1,] = c(x,res[1],res[2])\n\n}\n\nresult_df2 &lt;- arrange(result_df2, desc(X2_test_stat))\n\n\nThe top 10 most statistically significant group names are shown below:\n\n\nCode\nresult_df2 |&gt; ungroup() |&gt; top_n(10,X2_test_stat)\n\n\n          group_name X2_test_stat p_value\n1    Vaccine.Imprtnt        78443       0\n2   Vaccine.Confiden        45851       0\n3       Fr.Fam.Vaccd        33687       0\n4        Past.Vaccin        12886       0\n5      Covid.Concern         7882       0\n6           Age.Race         6893       0\n7                Age         5585       0\n8          Political         4616       0\n9        Work.School         3969       0\n10 Dr.Recommend.Vacc         3823       0\n\n\nTwo illustrative mosaic plots are shown below to confirm the chi square test result above - one for the group name with the highest Chi-Square score (the segment that felt vaccines were important), and one for the lowest (gender identity).\n\n\nCode\nmosaic_2var &lt;- function(df,indep_var_group_name,n_chars) {\nlibrary(vcd)\n  truncate_string &lt;- function(x) {\n  str_sub(x, 1, n_chars)}\n\nindep_var_group_name_no_spaces &lt;- gsub(\"[()\\\\[/\\\\\\\\ ]\", \".\", indep_var_group_name)\nindep_var_group_name_no_spaces &lt;- truncate_string(indep_var_group_name_no_spaces)\n\ntemp = df |&gt; ungroup() |&gt; filter(`Group Name` == indep_var_group_name) |&gt; mutate(n_not_hesitant = `Sample Size` - n_hesitant) |&gt;  select(`Group Category`, n_hesitant, n_not_hesitant,`Sample Size`) |&gt;  rename(\n    !!indep_var_group_name_no_spaces := `Group Category`,hesitant = `n_hesitant`, `not hesitant` = n_not_hesitant) |&gt; \n  pivot_longer(cols = hesitant:`not hesitant`,names_to = \"group\", values_to = \"Freq\" )\n\ntemp[[indep_var_group_name_no_spaces]] =  substr(temp[[indep_var_group_name_no_spaces]], 1, n_chars)\n\nformula = as.formula(paste(\"group\", \"~\", indep_var_group_name_no_spaces))\n\nmosaic(formula, direction = c(\"v\", \"h\"), temp,\n       highlighting_fill = c(\"grey80\", \"cornflowerblue\"),gp_varnames = gpar(fontsize = 10, fontface = 1), gp_labels = gpar(fontsize = 6))\nreturn(temp)\n}\n\nmosaic_2var(covid_2021_analysis,\"Vaccine.Imprtnt\",100)\n\n\n\n\n\n# A tibble: 4 × 4\n  Vaccine.Imprtnt     `Sample Size` group          Freq\n  &lt;chr&gt;                       &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt;\n1 A little_not at all         28357 hesitant      19088\n2 A little_not at all         28357 not hesitant   9269\n3 Somewhat_very              175006 hesitant       6501\n4 Somewhat_very              175006 not hesitant 168505\n\n\nCode\nmosaic_2var(covid_2021_analysis,\"G.Identity\",100)\n\n\n\n\n\n# A tibble: 6 × 4\n  G.Identity `Sample Size` group          Freq\n  &lt;chr&gt;              &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt;\n1 Cisgender         186524 hesitant      33215\n2 Cisgender         186524 not hesitant 153309\n3 Dont know          11179 hesitant       1864\n4 Dont know          11179 not hesitant   9315\n5 TG/Non bin          8087 hesitant       1371\n6 TG/Non bin          8087 not hesitant   6716\n\n\nIt can be clearly seen that those that saw a vaccine as important had significantly lower hesitance than those that did not. However, for the group name with the lowest Chi-Square score (gender identity), the observed and expected mosaic plots are nearly identical, thus confirming the Chi-Square test result.\n[add commentary on results]\n\n\n3.0.0.2 Part 2: Analyze which segments showed the greatest reduction in covid vaccine hesitancy between 2021 and 2023\nWe have already illustrated that national vaccine hesitance declined from around 18% in April/May 2021 to around 11% in May/June 2023.\n\n\nCode\n# Filter for the vaccination uptake and intent indicator\n# Filter for responses corresponding to vaccine hesitancy\n# Include all adults 18+\n# Set time period to monthly (excluding weekly samples) and filter for nationwide samples\nvacc_intention_time &lt;- covid |&gt;\n  filter(`Indicator Name` == 'Vaccination uptake and intention') |&gt;\n  filter(`Indicator Category` == 'Probably or definitely will not get vaccinated') |&gt;\n  filter(`Group Name` == 'All adults 18+') |&gt;\n  filter(`Time Type` == 'Monthly') |&gt;\n  filter(Geography == 'National') |&gt;\n  arrange(`Geography Type`, Geography, `Time Period`)\n\n# Derive month of data collection\nvacc_intention_time &lt;- vacc_intention_time |&gt;\n  mutate(month_split = paste0(str_split(`Time Period`, \"-\",\n                                        simplify = TRUE)[, 2],\n         \", \", Year),\n         month = mdy(month_split))\n\n# Plot hesitancy over time\nggplot(vacc_intention_time, aes(x = month, y = `Estimate (%)`,\n                                color = `Indicator Category`)) +\n  geom_line() +\n  labs(title = \"U.S. Vaccination Response Rates Over Time\",\n       x = \"Month\",\n       y = \"Response Rate (%)\") +\n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(title = \"Indicator Category:\"))\n\n\n\n\n\nHowever, some segments of the population demonstrated more decline in hesitance than others. The Cleveland dot plot below shows the change in hesitance by population segment, for the 20 most hesitant segments in 2021.\n\n\nCode\nannual_monthly_snapshots = c(\"April 22 - May 29\",\"May 1 - May 28\",\n                             \"April 30 - May 27\")\n\nsnapshots &lt;- covid |&gt;\n  filter(`Time Period` %in% annual_monthly_snapshots,\n         `Group Name` %in% group_name_toloop,\n         Geography == \"National\",\n         `Indicator Category` == \"Probably or definitely will not get vaccinated\" ) |&gt;\n  mutate(Year = as.factor(Year)) |&gt;\n  mutate_at(vars(`Group Name`), ~recode(., !!!group_name_shortening)) |&gt;\n  mutate_at(vars(`Group Category`), ~recode(., !!!group_cat_shortening)) |&gt;\n  mutate(rows = paste(`Group Name`, `Group Category`, sep = \" - \")) |&gt;\n  select(rows,Year,`Estimate (%)`) |&gt;\n  arrange(rows, Year) \n\nrow_order &lt;- snapshots |&gt;\n  pivot_wider(names_from = Year, values_from = `Estimate (%)`) |&gt;\n  drop_na(`2021`) |&gt;\n  drop_na(`2023`) |&gt;\n  mutate(decline_21_23 = `2021` - `2023`) |&gt;\n  arrange((decline_21_23))\n\nrow_order_list_chg_21_23 &lt;- c(row_order$rows)\n\nrow_order_list_2021 &lt;- row_order |&gt;\n  arrange(`2021`) |&gt;\n  top_n(20,`2021`) |&gt;\n  select(rows)\n\nrow_order_list_2021 &lt;- row_order_list_2021$rows               \n\nrow_order_list_2023 &lt;- c(row_order |&gt;\n                           arrange((`2023`)) |&gt;\n                           select(rows))\n\nsnapshots &lt;- snapshots[snapshots$rows %in% row_order_list_chg_21_23, ]\n\n\nsnapshots |&gt; filter(rows %in% row_order_list_2021) |&gt;\n  ggplot(aes(x = `Estimate (%)`, y = fct_relevel(rows,(row_order_list_2021)),\n             color = Year)) +\n  geom_point(size = 1) +\n  labs(title = \"20 most hesitant segments in 2021, and changes in 2022-23\",\n       x = \"Vaccine hesitance (%)\", y = \"Sample segments\") +\n  theme(legend.position = \"bottom\",axis.text.x = element_text(size = 10),\n        axis.text.y = element_text(size = 6), plot.title = element_text(size = 10))\n\n\n\n\n\nIt can be seen from the cleveland dot plot that the change in hesitance of the top 20 most hesitant segments in 2021 varies by group. The bar graph below shows the 10 population segments that demonstrated the largest changes in hesitance.\n\n\nCode\n#barplot of change\nlibrary(stringr)\nrow_order$rows &lt;- str_wrap(row_order$rows, width = 10)\n\nrow_order |&gt;\n  top_n (10, decline_21_23) |&gt;\n  ggplot(aes(x = fct_reorder(rows,rev(decline_21_23)), y = decline_21_23)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Top 10 categories with the largest 2021-23 changes\",\n       x = \"Group categories\", y = \"2021-23 change in hesitance\") +\n  theme_minimal() + \n  theme(axis.text.x = element_text(angle = 0, vjust = 1, hjust=0.5,size=6),\n        axis.text.y = element_text(size=8),\n        axis.title = element_text(size = 8),\n        plot.title = element_text(size = 8))\n\n\n\n\n\nThe change in hesitance also varies by state:\n\n\nCode\ncomparison_baseline_2021 &lt;- covid |&gt;\n  filter(`Year` == 2021, `Time Type` == \"Monthly\",\n         `Time Period` == \"April 22 - May 29\",\n         `Group Category`== \"All adults age 18+ years\",\n         `Geography Type` %in% c(\"Jurisdictional Estimates\"),\n         `Indicator Category` == \"Probably or definitely will not get vaccinated\",\n         !grepl(\"-\", Geography)) |&gt;\n  mutate(n_hesitant = round(`Estimate (%)`/100 * `Sample Size`, 0)) |&gt;\n  group_by(Geography) |&gt;\n  summarise(`Sample Size` = sum(`Sample Size`),\n            n_hesitant = sum(n_hesitant)) |&gt;\n  mutate(`Estimate (%)` = n_hesitant / `Sample Size` * 100,\n         `Time Period` = \"2021 most recent snapshot\",\n         Year = 2021)\n\ncovid_2023_analysis_allstates &lt;- covid |&gt;\n  filter(`Year` == 2023, `Time Type` == \"Monthly\",\n         `Time Period` == \"May 28 - June 30\",\n         `Group Category`== \"All adults age 18+ years\",\n         `Geography Type` %in% c(\"Jurisdictional Estimates\"),\n         `Indicator Category` == \"Probably or definitely will not get vaccinated\",\n         !grepl(\"-\", Geography)) |&gt;\n  mutate(n_hesitant = round(`Estimate (%)`/100 * `Sample Size`, 0)) |&gt;\n  group_by(Geography) |&gt;\n  summarise(`Sample Size` = sum(`Sample Size`),\n            n_hesitant = sum(n_hesitant)) |&gt;\n  mutate(`Estimate (%)` = n_hesitant / `Sample Size` * 100,\n         `Time Period` = \"2023 most recent snapshot\",\n         Year = 2023)\n\n\nstate_delta &lt;- left_join(covid_2023_analysis_allstates,\n                         comparison_baseline_2021 |&gt;\n                           select(Geography, estimate_2021 = `Estimate (%)`),\n                         by = \"Geography\")\n\nstate_delta &lt;- state_delta |&gt;\n  mutate(`Change in Hesitancy Rates` = `Estimate (%)` - estimate_2021)\n\nstate_delta_map &lt;- state_delta |&gt;\n  select(Geography, `Change in Hesitancy Rates`) |&gt;\n  transmute(region = tolower(Geography),\n            value = as.numeric(`Change in Hesitancy Rates`))\n\n\n# red_green_palette &lt;- brewer.pal(n = 7, name = \"RdYlGn\")\n\nstate_choropleth(state_delta_map,\n                 title = \"   2021-2023 Changes in Vaccine Hesitance by State\",\n                 legend = \"Change in \\nHesitancy Rates   \",\n                 num_colors = 0)\n\n\n\n\n\n\n\nCode\nhesitance_state_group_cat &lt;- covid_hes_prepped |&gt;\n  filter(`Geography Type` %in% c(\"Jurisdictional Estimates\"),\n         !grepl(\"-\", Geography)) |&gt;\n  mutate(month_split = paste0(str_split(`Time Period`, \"-\",\n                                        simplify = TRUE)[, 2], \", \", Year),\n         month = mdy(month_split),\n         n_hesitant = round(`Estimate (%)`/100 * `Sample Size`, 0)) |&gt;\n  group_by(Geography, `Group Name`, `Group Category`, concat, month) |&gt;\n  summarise(`Sample Size` = sum(`Sample Size`),\n            n_hesitant = sum(n_hesitant)) |&gt;\n  mutate(`Estimate (%)` = n_hesitant / `Sample Size` * 100,\n         concat_no_state = concat,\n         concat = paste0(Geography, \": \", concat)) |&gt;\n  ungroup()\n\n\nd3_input_prep &lt;- hesitance_state_group_cat |&gt;\n  pivot_wider(id_cols = month, names_from = \"concat\", values_from = `Estimate (%)`) |&gt;\n  dplyr::rename(Category = month)\n\nd3_input_prep[is.na(d3_input_prep)] &lt;- 0\n\n\nwrite_csv(d3_input_prep, \"D3 Inputs/All State-Category Values.csv\")\n\n\ndropdown_selections &lt;- hesitance_state_group_cat |&gt;\n  distinct(Geography, concat_no_state)\n\nwrite_csv(dropdown_selections, \"D3 Inputs/Dropdown Choices.csv\")\n\n\n\n\n3.0.0.3 Part 3: Based on the findings above, we will propose high-level recommendations for segments of the population that need further public health interventions.\nProvide a short nontechnical summary of the most revealing findings of your analysis written for a nontechnical audience. Take extra care to clean up your graphs, ensuring that best practices for presentation are followed, as described in the audience ready style section below.\nUse subheadings (##) as appropriate. See Todd Schneider’s blog posts for examples of thoughtful, informative subheadings. An approach that works well is to create a subheading for each of your research questions.\nThe number of graphs will vary by project; we suggest a target of 10. (A plot with multiple facets counts as 1 graph). If you go over, make sure they are high quality and include commentary. A project with 10 good graphs plus commentary will receive a better grade than a project with 10 good graphs and 10 mediocre ones."
  }
]